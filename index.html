<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Chicken Cross the Road</title>
  <style>
    body {
      background: #e0f7fa;
      display: flex;
      flex-direction: column;
      align-items: center;
      font-family: Arial, sans-serif;
      margin: 0;
      height: 100vh;
    }
    h1 {
      margin-top: 20px;
      margin-bottom: 10px;
    }
    #score {
      font-size: 1.2em;
      margin-bottom: 10px;
    }
    #gameArea {
      position: relative;
      width: 400px;
      height: 500px;
      background: #a5d6a7;
      border: 4px solid #333;
      overflow: hidden;
      box-shadow: 0 4px 16px #888;
    }
    .lane {
      position: absolute;
      left: 0;
      width: 100%;
      height: 60px;
      background: #fffde7;
      border-bottom: 2px dashed #bbb;
    }
    .rest {
      position: absolute;
      left: 0;
      width: 100%;
      height: 60px;
      background: #ffe082;
      border-bottom: 2px solid #bbb;
      z-index: 0;
    }
    .car {
      position: absolute;
      top: 10px;
      font-size: 2em;
      /* Remove transition for smooth movement */
    }
    #chicken {
      position: absolute;
      left: 180px;
      font-size: 2em;
      transition: top 0.1s, left 0.1s;
      z-index: 2;
    }
  </style>
</head>
<body>
  <h1>üêî Chicken Cross the Road</h1>
  <div id="score">Score: 0</div>
  <div id="gameArea"></div>
  <script>
    const gameArea = document.getElementById('gameArea');
    const scoreDiv = document.getElementById('score');
    const laneCount = 5; // Fewer lanes for easier game
    const laneHeight = 60;
    const areaWidth = 400;
    const areaHeight = 500;
    const restAreaCount = 2; // Start and top rest area
    let score = 0;
    let bestScore = 0;
    let chicken = { x: 180, y: areaHeight - laneHeight, size: 40 };
    let cars = [];
    let carSpeeds = [1.2, 1.5, 1.1, 1.7, 1.3]; // Slower cars
    let carDirections = [1, -1, 1, -1, 1];
    let gameRunning = true;

    // Draw rest areas (bottom and top)
    for (let i = 0; i < restAreaCount; i++) {
      const rest = document.createElement('div');
      rest.className = 'rest';
      rest.style.top = (i * (areaHeight - laneHeight)) + 'px';
      gameArea.appendChild(rest);
    }
    // Draw lanes (between rest areas)
    for (let i = 0; i < laneCount; i++) {
      const lane = document.createElement('div');
      lane.className = 'lane';
      lane.style.top = ((i + 1) * laneHeight) + 'px';
      gameArea.appendChild(lane);
    }

    // Add chicken
    const chickenDiv = document.createElement('div');
    chickenDiv.id = 'chicken';
    chickenDiv.innerText = 'üêî';
    gameArea.appendChild(chickenDiv);

    // Add cars
    function spawnCars() {
      // Remove old cars
      for (let car of cars) {
        if (car.div.parentNode) car.div.parentNode.removeChild(car.div);
      }
      cars = [];
      for (let i = 0; i < laneCount; i++) {
        const car = document.createElement('div');
        car.className = 'car';
        car.innerText = Math.random() > 0.5 ? 'üöó' : 'üöô';
        let left = carDirections[i] === 1 ? -60 : areaWidth + 20;
        car.style.left = left + 'px';
        car.style.top = ((i + 1) * laneHeight + 10) + 'px';
        gameArea.appendChild(car);
        cars.push({
          div: car,
          lane: i,
          x: left,
          speed: carSpeeds[i] + Math.random() * 0.5,
          dir: carDirections[i]
        });
      }
    }
    spawnCars();

    function resetChicken() {
      chicken.x = 180;
      chicken.y = areaHeight - laneHeight;
      updateChicken();
    }

    function updateChicken() {
      chickenDiv.style.left = chicken.x + 'px';
      chickenDiv.style.top = chicken.y + 'px';
    }

    function updateScore() {
      scoreDiv.innerText = `Score: ${score}  |  Best: ${bestScore}`;
    }

    function moveCars() {
      for (let car of cars) {
        car.x += car.speed * car.dir;
        if (car.dir === 1 && car.x > areaWidth + 20) {
          car.x = -60;
        } else if (car.dir === -1 && car.x < -60) {
          car.x = areaWidth + 20;
        }
        car.div.style.left = car.x + 'px';
      }
    }

    function checkCollision() {
      for (let car of cars) {
        let carY = (car.lane + 1) * laneHeight;
        if (
          chicken.y < carY + laneHeight - 10 &&
          chicken.y + chicken.size > carY + 10 &&
          chicken.x + chicken.size > car.x &&
          chicken.x < car.x + 40
        ) {
          return true;
        }
      }
      return false;
    }

    function gameLoop() {
      if (!gameRunning) return;
      moveCars();
      if (checkCollision()) {
        if (score > bestScore) bestScore = score;
        score = 0;
        updateScore();
        resetChicken();
      }
      // Check if crossed all lanes (reached top rest area)
      if (chicken.y < laneHeight) {
        resetChicken();
        spawnCars();
      }
      requestAnimationFrame(gameLoop);
    }

    document.addEventListener('keydown', (e) => {
      if (!gameRunning) return;
      if (e.key === 'ArrowUp') {
        if (chicken.y - laneHeight >= 0) {
          chicken.y -= laneHeight;
          score++;
          updateScore();
        }
      } else if (e.key === 'ArrowDown') {
        if (chicken.y + laneHeight < areaHeight) {
          chicken.y += laneHeight;
          score++;
          updateScore();
        }
      } else if (e.key === 'ArrowLeft') {
        if (chicken.x - 20 >= 0) chicken.x -= 20;
      } else if (e.key === 'ArrowRight') {
        if (chicken.x + 20 <= areaWidth - chicken.size) chicken.x += 20;
      }
      updateChicken();
    });

    updateChicken();
    updateScore();
    gameLoop();
  </script>
</body>
</html>
